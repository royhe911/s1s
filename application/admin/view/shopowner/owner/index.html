<script type="text/javascript" src="__CDN__/assets/libs/laydate5/laydate.js"></script>
<script src="__CDN__/assets/js/vue.min.js"></script>
<style>
     @media screen and (max-width:1260px) {
        .shop-i{
            margin-top: 10px ;
        }
        .shop-i {
            float: left !important;
        }
    }
    @media screen and (max-width:1040px) {
        .shop-t{
            margin-top: 10px ;
        }
    }
    @media screen and (max-width:1160px) {
        .shop-s {
            margin-top: 10px ;
        }
    }
    th>div {
        line-height: 36px;
    } 
    
    #toolbar{
    	position:relative;    	
    }
    #toolbar  .num{
    	position:absolute;
    	right:0px;
    	top:0px;
    }  
    #toolbar  .num .num_list{
    	width:110px;
    	height:35px;
    	padding-left:10px;
    	outline: none;
    }
</style>
<div class="panel panel-default panel-intro">
    <div class="panel-heading row" style="padding-top:0;color: #999;font-size: 12px; line-height: 50px; background-color: transparent">
        <!-- <div class="panel-lead"><em>门店分类管理</em></div> -->
        <div style="background-color: #e8edf0;width: 100%; height: 50px;padding-left: 15px">
            <div class="lf">
                <i class="fa fa-home" style="font-size: 14px;"></i>
            </div>
            <div class="panel-lead lf" style="margin: 0px;">商户管理&nbsp;&nbsp;&nbsp;> </div>
            <div class="panel-lead lf pl" style="margin: 0px;color: #34c191;">&nbsp;&nbsp;&nbsp;商户列表</div>
        </div>
    </div>
    <div class="panel-body">
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="one">
                <div class="widget-body no-padding">
                    <div class="bootstrap-table">
                        <div class="fixed-table-toolbar">
                            <div class="bs-bars">
                                <div id="toolbar" class="toolbar" style="position: relative;">
                                    <form id="search_form" class="form-inline" role="form" data-toggle="validator" method="get" action="">
                                        <div class="row"  style="margin:0;">
                                            <div style="float: left;width: 150px;margin-right: 10px;">
                                                <input class="form-control title-input" style="width: 150px;" name="keyword" type="text" value="{$Think.get.keyword ?? ''}" placeholder="手机号/昵称">
                                            </div>
                                            
                                            <div style="float: left;width: 150px;margin-right: 10px;">
                                                <select class="form-control title-input" name="status" v-model="status"  style="width: 150px;">
                                                    <option value="-1">状态</option>
                                                    <option value="1" {if 1 == $status}selected{/if}>启用</option>
                                                    <option value="0" {if 0 == $status}selected{/if}>停用</option>
                                                </select>
                                            </div>
                                            
                                            <div style="float: left;width: 330px;margin-right: 10px;width: 180px;" class="shop-t">
                                                <input class="input-text laydate-icon os-pl-10" style="width: 180px; height: 36px;padding-left: 8px;font-size: 12px;border:1px solid #d2d6de"
                                                    type="text" id="fromTime" name="from_time" placeholder="搜索时间区间" value="{$Think.get.from_time ?? ''}" onfocus="this.blur()" />
                                            </div>
                                            <div style="float: left;width: 100px;margin-right: 25px; height: 36px;" class="shop-s">
                                                <button type="submit" class="btn btn-success btn-ok btn-embossed br" style="width: 100%;height: 36px; border-radius: 4px;background-color: #34c191;">搜索</button>
                                            </div>                                          
                                        </div>
                                    </form>

                                    <div class="form-inline" >                                        
                                        <p style="float: right;font-size: 12px;padding: 8px;margin:0">共计 <span style="color: #34c191;">{$list->total()}</span> 个商户</p>
                                    </div>
                                    <div class="num">
                                    	<select name="" id="" class="num_list" style="border-color: #34C191;">
                                    		<option value="0">查看条数</option>
                                            {volist name='page_list' id='vo'}
                                            <option value="{$vo}" {if $Think.session.cur_limit eq $vo}selected{/if}>{$vo}</option>
                                            {/volist}
                                    	</select>
                                    </div>
                                </div>
                            </div>                                                               
                            
                        </div>
                        <div id="show_data" class="fixed-table-container" style="padding-bottom: 0px;">
                            <div class="fixed-table-header" style="display: none;">
                                <table></table>
                            </div>
                            <div class="fixed-table-body">
                                <table id="table" class="table table-striped table-bordered table-hover" data-operate-edit="1" data-operate-del="1" width="100%">
                                    <thead>
                                    <tr style="background-color:#e8f7f2">
                                        <th class="bs-checkbox " style="text-align: center; vertical-align: middle; width: 36px; " data-field="0">
                                            <div class="th-inner ">
                                                <input name="btSelectAll" id="btSelectAll" type="checkbox" disabled="disabled">
                                            </div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="id">
                                            <div class="th-inner ">用户名称</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="name">
                                            <div class="th-inner ">联系电话</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="nickname">
                                            <div class="th-inner ">注册时间</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="status">
                                            <div class="th-inner ">门店信息</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="status">
                                            <div class="th-inner ">状态</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="status">
                                            <div class="th-inner ">来源</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="operate">
                                            <div class="th-inner ">操作</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                       
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {volist name='list' id='vo'}
                                    <tr class="ac-tr">
                                        <th class="bs-checkbox " style="text-align: center; vertical-align: middle; width: 36px; " data-field="0">
                                            <div class="th-inner ">
                                                <input class="checkCC" name="btSelectItem"  type="checkbox">
                                            </div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        
                                        <th style="text-align: center; vertical-align: middle; " data-field="id">
                                            {$vo.nickname}
                                        </th>
                                        
                                        <th class="ac-store-name-tr" style="text-align: center; vertical-align: middle; " data-field="name">
                                            {if $is_super}
                                            {$vo.mobile}
                                            {else}
                                            {$vo.mobile ? substr_replace($vo.mobile, '****', 3, 4) : ''}
                                            {/if}
                                        </th>
                                        
                                        <th style="text-align: center; vertical-align: middle; " data-field="nickname">
                                            {$vo.create_time}
                                        </th>                                                                               
                                        
                                        <th style="text-align: center; vertical-align: middle; " data-field="status">
                                            {if $vo.is_status == 1}
                                            <a title="查看商家详细" class="goodsCC"  href="/shopowner/owner/look_shop?business_id={$vo.id}" style="color:#34c191">查看</a>
                                            {else}
                                            未认领
                                            {/if}
                                        </th>

                                        <th style="text-align: center; vertical-align: middle; " data-field="status">
                                            {if ($vo.status eq 1)}
                                            <a class="indexCC btn-change text-success ac-is-stop" href="javascript:;" data-status="1" data-id="{$vo.id}"  title="禁用">
                                                <i class="fa fa-toggle-on fa-2x" style="color: #18bc9c;"></i>
                                            </a>
                                            {else}
                                            <a class="indexCC btn-change text-success ac-is-stop" href="javascript:;" data-status="0" data-id="{$vo.id}" title="启用">
                                                <i class="fa fa-toggle-off fa-2x" style="color: #18bc9c;"></i>
                                            </a>
                                            {/if}
                                        </th>
                                        
                                        <th style="text-align: center; vertical-align: middle; " data-field="status" > {$device[$vo.device] ?? ''}</th>
                                        
                                        <th style="text-align: center; vertical-align: middle;width: 100px; " data-field="operate">                                                                                            
                                            <a class="albumCC" title="修改密码" style="color: #9f9f9f; margin-left:5px; display: inline-block" onclick="layer_open('修改密码', '/shopowner/owner/re_pass?business_id={$vo.id}',{w:'350px',h:'250px'});" href="javascript:void(0)">
                                                <i class="iconfont icon-edit"></i>
                                            </a>                                                                                         
                                        </th>
                                        
                                    </tr>
                                   {/volist}
                                    </tbody>
                                </table>
                                <script>
                                    $(".ac-is-stop").on("click", function () {
                                        // console.log('++++++++++++++++++++++++++++++++++++');
                                        // console.log($(this).attr('data-status'))
                                        // console.log('++++++++++++++++++++++++++++++++++++');
                                        if ($(this).attr('data-status') == 1) {
                                            $(this).parent().next().children('.btn-editone').removeClass('btn-s').addClass('editClick')
                                        } else {
                                            $(this).parent().next().children('.btn-editone').removeClass('editClick').addClass('btn-s')
                                            // $('this').css('backgroundColor', '#34c191')
                                        }
                                    });

//                                 
                                </script>
                            </div>
                            <div class="fixed-table-footer" style="display: none;">
                                <table>
                                    <tbody>
                                    <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="fixed-table-pagination">{$list->render()|raw}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
        $('#btSelectAll').attr('disabled',false)
        //切换条数
        $('.num_list').change(function(){
        	var value=$(this).find('option:selected').val();
        	var keyword=$('input[name="keyword"]').val();       	        	                                  	
        	var status=$('select[name="status"]').find('option:selected').val();        	
        	var from_time=$('input[name="from_time"]').val();
        	
        	location.href = '/shopowner/owner/index?cur_limit=' + value+'&keyword='+keyword+'&from_time='+from_time+'&status='+status; 
        	          
        })
        
        // 编辑状态
        $(".indexCC").on("click", function () {
            var obj = {
                url: '/shopowner/owner/edit_status',
                info_msg: '请选择要操作的商品',
                show_stop: "取消推荐",
                show_start: "推荐"
            };
            obj.os_this = $(this);
            obj.is_stop = $(this).attr("data-isStop");
            obj.id = $(this).attr("data-id");
            is_stop(obj);
        });

        /**
         * 加载时间插件
         */
        laydate.render({
            elem: '#fromTime'
            ,range: true
            ,value: "{$Request.get.from_time ?? ''}"
        });
    })();
</script>
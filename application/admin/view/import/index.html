<script src="https://cdn.bootcss.com/vue/2.5.16/vue.min.js"></script>
<div class="panel panel-default panel-intro">
    <div class="panel-heading row" style="padding-top:0;color: #999;font-size: 12px; line-height: 50px; background-color: transparent">
        <div style="background-color: #e8edf0;width: 100%; height: 50px;padding-left: 15px">
            <div class="lf">
                <i class="fa fa-home" style="font-size: 14px;"></i>
            </div>
            <div class="panel-lead lf" style="margin: 0px;">导入管理&nbsp;&nbsp;&nbsp;> </div>
            <div class="panel-lead lf pl" style="margin: 0px;color: #34c191;">&nbsp;&nbsp;&nbsp;导入列表 </div>
        </div>
    </div>
    <div class="panel-body">
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="one">
                <div class="widget-body no-padding">
                    <div class="bootstrap-table">
                        <div class="fixed-table-toolbar">
                            <div class="row" style="margin:0;">
                                <div class="bs-bars pull-left" style="width: 100%;margin-bottom: 0">
                                	<div class="num" style="float: right;margin-left:15px;">
		                            	<select class="form-control title-input num_list" style="width: 100px;border-color:#18BC9C;border-radius: 4px;" name="" id="">
		                                	<option value="0">查看条数</option>
		                                	{volist name='page_list' id='vo'}
		                                	<option value="{$vo}" {if $Think.session.cur_limit eq $vo}selected{/if}>{$vo}</option>
		                                	{/volist}
		                                </select>
		                            </div>  
                                    <div style="float: right;width: 100px;">
                                        <a href="javascript:;" onclick="layer_open('门店导入', '/shops/upload_shop_file',{w:'400px',h:'195px'})" class="btn btn-success btn-add bs-bars-com" style="width: 100%; float: right; background-color: #34c191; border-radius: 4px; height: 36px;" title="门店导入">门店导入</a>                                     
                                    </div>                                   
                                </div>
                                <p style="float: right;font-size: 12px;line-height:30px;margin:0;">共计 <span style="color: #34c191;">{$list->total()}</span> 条数据</p>
                            </div>
                        </div>
                        <div class="fixed-table-container" style="padding-bottom: 0px;">
                            <div class="fixed-table-header" style="display: none;">
                                <table></table>
                            </div>
                            <div class="fixed-table-body">

                                <table id="table" class="table table-striped table-bordered table-hover" data-operate-edit="1" data-operate-del="1" width="100%">
                                    <thead>
                                        <tr style="background-color: #e8f7f2;">
                                            <th class="bs-checkbox " style="text-align: center; vertical-align: middle; width: 36px; " data-field="0">
                                                <div class="th-inner ">
                                                    <input name="btSelectAll" id="btSelectAll" type="checkbox">
                                                </div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">批次号</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">总数</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">导入条数</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">错误条数</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">导入时间</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                            <th style="text-align: center; vertical-align: middle; " data-field="">
                                                <div class="th-inner ">操作</div>
                                                <div class="fht-cell"></div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody data-listidx="0">
                                        {volist name='list' id='vo'}
                                        <tr>
                                            <td class="bs-checkbox ">
                                                <input data-index="{$i-1}" value="{$vo.id}" name="btSelectItem" type="checkbox">
                                            </td>
                                            <td style="text-align: center; vertical-align: middle; ">{$vo.branch_no}</td>
                                            <td style="text-align: center; vertical-align: middle; ">{$vo.import_count}</td>
                                            <td style="text-align: center; vertical-align: middle; ">{$vo.import_suc_count}</td>
                                            <td style="text-align: center; vertical-align: middle; ">{$vo.import_err_count}</td>
                                            <td style="text-align: center; vertical-align: middle; ">{$vo.create_time}</td>
                                            <td style="text-align: center; vertical-align: middle; ">
                                                <a href="/import/import_suc/branch_no/{$vo.branch_no}" class="albumCC btn-editone" title="查看成功数据" data-table-id="table" data-field-index="9"
                                                   data-row-index="0" data-button-index="0">
                                                    查看成功数据
                                                </a>
                                                <a href="/import/import_err/branch_no/{$vo.branch_no}" class="albumCC btn-delone" title="查看错误数据" data-table-id="table" data-field-index="9"
                                                    data-row-index="0" data-button-index="0">
                                                    查看错误数据
                                                </a>
                                                <a href="/import/import_like/branch_no/{$vo.branch_no}" class="albumCC btn-delone" title="查看重复数据" data-table-id="table" data-field-index="9"
                                                    data-row-index="0" data-button-index="0">
                                                    查看重复数据
                                                </a>
                                            </td>
                                        </tr>
                                        {/volist}
                                    </tbody>
                                </table>
                            </div>
                            <div class="fixed-table-footer" style="display: none;">
                                <table>
                                    <tbody>
                                        <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="fixed-table-pagination">{$list->render()|raw}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
    	
		$('.num_list').change(function(){
	    	var value=$(this).find('option:selected').val();	    	
	    	location.href = '/import/index?cur_limit=' + value;
	  	})  
	  	
        var prevent_more_click = true;
        $(".ac-is-stop").on("click", function () {
            if(prevent_more_click) {
                var obj = {
                    url: '/good/edit_status',
                    info_msg: '请选择要操作的商品',
                    show_stop: "下架",
                    show_start: "上架"
                };
                obj.os_this = $(this);
                obj.is_stop = $(this).attr("data-isStop");
                obj.id = $(this).attr("data-id");
                is_stop(obj);
                prevent_more_click = false;
                setTimeout(function () {
                    prevent_more_click = true;
                }, 600);
            }
        });
        $(".ac-is-index").on("click", function () {
            if(prevent_more_click) {
                var obj = {
                    url: '/good/edit_index',
                    info_msg: '请选择要操作的商品',
                    show_stop: "取消推荐",
                    show_start: "推荐"
                };
                obj.os_this = $(this);
                obj.is_stop = $(this).attr("data-isStop");
                obj.id = $(this).attr("data-id");
                is_stop(obj);
                prevent_more_click = false;
                setTimeout(function () {
                    prevent_more_click = true;
                }, 600);
            }
        });
    })();

    function del(ids) {
        if (ids == 0) {
            ids = get_select_all();
        }
        if (ids == '') {
            layer.msg('请选择要操作的商品');
            return false;
        }
        $.post('/good/delete', { ids: ids }, function (data) {
            if (data.code == 1) {
                layer.msg(data.msg, {
                    time: 2000 //2秒关闭（如果不配置，默认是3秒）
                }, function () {
                    window.parent.location.reload();
                });
            } else {
                layer.msg(data.msg);
            }
        }, 'json')
    }
    
</script>
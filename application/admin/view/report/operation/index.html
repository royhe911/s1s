<link rel="stylesheet" type="text/css" href="__CDN__/assets/libs/laydate/need/laydate.css?v={$site.version}"/>
<script type="text/javascript" src="__CDN__/assets/libs/laydate5/laydate.js"></script>
<div class="panel panel-default panel-intro">
    <div class="panel-heading row" style="padding-top:0;color: #999;font-size: 12px; line-height: 50px; background-color: transparent">
        <div style="background-color: #e8edf0;width: 100%; height: 50px;padding-left: 15px">
            <div class="lf">
                <i class="fa fa-home" style="font-size: 14px;"></i>
            </div>
            <div class="panel-lead lf" style="margin: 0px;">报表管理&nbsp;&nbsp;&nbsp;> </div>
            <div class="panel-lead lf pl" style="margin: 0px;color: #34c191;">&nbsp;&nbsp;&nbsp;市场部门操作记录</div>
        </div>
    </div>
    <div class="panel-body">
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="one">
                <div class="widget-body no-padding">
                    <div class="bootstrap-table">
                        <div class="fixed-table-toolbar">
                            <form id="edit-form" class="form-horizontal" role="form" data-toggle="validator" method="get" action="">
                                <div class="row"  style="margin:0;">
                                    <div style="float: left;width: 150px;margin-right: 10px;">
                                        <input class="form-control title-input" name="keyword" type="text" value="{$Request.get.keyword ?? ''}" placeholder="手机号码/操作人">
                                    </div>
                                    <div style="float: left;width: 150px; height: 36px; margin-right: 10px;">
                                        <select class="form-control title-input" name="region_id_1" id="region_id_1" onchange='javascript:get_type("city_id", this.value, 0)'>
                                            <option value="">--省--</option>
                                            {volist name='region_list_1' id='vo'}
                                            <option value="{$key}" {if $Request.get.region_id_1 eq $key}selected{/if}>{$vo}</option>
                                            {/volist}
                                        </select>
                                    </div>
                                    <div style="float: left;width: 150px; height: 36px; margin-right: 10px;">
                                        <select class="form-control title-input"  name="city_id" id="city_id">
                                            <option value="">市</option>
                                        </select>
                                    </div>
                                    <div style="float: left;width: 150px;margin-right: 10px;">
                                        <select class="form-control title-input" required="" name="type">
                                            <option>全部</option>
                                            {volist name='type' id='vo'}
                                            <option value="{$i}" {if $Request.get.type eq $i} selected="selected"{/if}>{$vo}</option>
                                            {/volist}
                                        </select>
                                    </div>
                                    <div style="float: left;width: 230px;margin-right: 10px;">
                                        <input class="input-text laydate-icon os-pl-10" style="width: 230px; height: 36px;padding-left: 8px;font-size: 12px;border:1px solid #d2d6de" type="text" id="fromTime" name="from_time" placeholder="搜索时间区间" onfocus="this.blur()"/>
                                    </div>
                                    <div style="float: left;width: 100px;">
                                        <button type="submit" class="btn btn-success btn-ok btn-embossed" style="width: 100%;height: 36px; border-radius: 4px;background-color: #34c191;">搜 索</button>
                                    </div>                                    
                                </div>
                                <div style="margin-top:10px;">
                                	<div class="clearfix">
                                		<div class="num pull-right" >
			                            	<select class="pull-left form-control title-input num_list" style="width:120px;border-color:#34C191;margin-left:20px;">
			                                	<option value="0">查看条数</option>
			                                	{volist name='page_list' id='vo'}
			                                	<option value="{$vo}" {if $Think.session.cur_limit eq $vo}selected{/if}>{$vo}</option>
			                                	{/volist}
			                                </select>
			                            </div> 
                                		<a href="javascript:;" onclick="export_data(0)" class="btn btn-success bs-bars-com btn-add pull-right" title="导出"> 导出</a>
                                	</div>
                                    <p style="float: right;font-size: 12px;line-height:35px;margin:0;">共计 <span style="color: #34c191;">{$list->total()}</span> 个记录</p>
                                </div>
                            </form>
                        </div>
                        <div class="fixed-table-container" style="padding-bottom: 0px;">
                            <div class="fixed-table-header" style="display: none;">
                                <table></table>
                            </div>
                            <div class="fixed-table-body">

                                <table id="table" class="table table-striped table-bordered table-hover" data-operate-edit="1" data-operate-del="1" width="100%">
                                    <thead>
                                    <tr>
                                        <th class="bs-checkbox " style="text-align: center; vertical-align: middle; width: 36px; " data-field="0">
                                            <div class="th-inner "><input name="btSelectAll" id="btSelectAll" type="checkbox"></div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">Id</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">门店id</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">门店名称</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">门店分类</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">省</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">市</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">区</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">门店地址</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">操作类型</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">操作人</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                        <th style="text-align: center; vertical-align: middle; " data-field="">
                                            <div class="th-inner ">操作时间</div>
                                            <div class="fht-cell"></div>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-listidx="0">
                                    {volist name='list' id='vo'}
                                    <tr>
                                        <td class="bs-checkbox ">
                                            <input data-index="{$i-1}" value="{$vo.id}" name="btSelectItem" type="checkbox">
                                        </td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.id}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.shop_id}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.shop_name}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.shop_type}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.region1.0.name ?? ''}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.region2.0.name ?? ''}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.region3.0.name ?? ''}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.address}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$type[$vo.type] ?? ''}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.nickname}</td>
                                        <td style="text-align: center; vertical-align: middle; ">{$vo.create_time}</td>
                                    </tr>
                                    {/volist}
                                    </tbody>
                                </table>
                            </div>
                            <div class="fixed-table-footer" style="display: none;">
                                <table>
                                    <tbody>
                                    <tr></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="fixed-table-pagination">{$list->render()|raw}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function(){
    	//切换显示条数
		$('.num_list').change(function(){
	    	var value=$(this).find('option:selected').val();
	    	var keyword=$('input[name="keyword"]').val();   	
	    	var region_id_1=$('select[name="region_id_1"]').find('option:selected').val();
	    	var city_id=$('select[name="city_id"]').find('option:selected').val();
	    	var type=$('select[name="type"]').find('option:selected').val();
	    	var from_time=$('input[name="from_time"]').val();
	    	location.href = '/report/operation/index?cur_limit=' + value+'&keyword='+keyword+'&region_id_1='+region_id_1+'&city_id='+city_id+'&type='+type+'&from_time='+from_time;        	    
	    })
    })
    function export_data(ids) {
        if (ids == 0) {
            ids = get_select_all();
        }
        if (ids == '') {
            alert('请选择要操作的数据');
            return false;
        }
        location.href = 'operation/export_data?ids='+ids;
    }

     /**
     * 加载时间插件
     */
    laydate.render({
        elem: '#fromTime'
        ,range: true
        ,value: "{$Request.get.from_time ?? ''}"
    });
</script>